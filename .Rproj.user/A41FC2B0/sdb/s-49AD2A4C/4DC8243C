{
    "contents" : "#phewas <-\n#  function(phenotypes,genotypes,data,covariates=c(NA),adjustments=list(NA),\n#outcomes, predictors, cores=1, additive.genotypes=T,\n#           significance.threshold, alpha=0.05, unadjusted=F,\n#return.models=F, min.records=20, MASS.confint.level=NA,quick.confint.level) {\n#  }\n\n# What abstractions do I want to make here? Probably covariates, adjustments,\n# Significance threshold: significance.threshold=c(\"bonferroni\")\n#thresh=match(c(\"p-value\",\"bonferroni\",\"fdr\",\"simplem-genotype\",\n#\"simplem-phenotype\",\"simplem-product\")\n\n#S3/S4 objects. Like, a<-phewas(phenotypes,genotypes) then p_w_b(a)\n#chaining with magrittr?\n\nphewas_with_bonferroni<-\n  function(phenotypes,genotypes, alpha=0.05, explain=TRUE, verbose=TRUE){\n    res <- phewas(phenotypes,genotypes,cores=1,alpha=alpha,significance.threshold=c(\"bonferroni\"))\n    if (explain) {explain_phewas_bon(res,verbose)}\n    return(res)\n  }\n\nphewas_with_fdr<-\n  function(phenotypes,genotypes, alpha=0.05, explain=TRUE, verbose=TRUE){\n    res <- phewas(phenotypes,genotypes,cores=1,alpha=alpha,significance.threshold=c(\"fdr\"))\n    if (explain) {explain_phewas_fdr(res,verbose)}\n    return(res)  }\n\nphewas_with_both<-\n  function(phenotypes,genotypes, alpha=0.05, explain=TRUE, verbose=TRUE){\n    phewas(phenotypes,genotypes,cores=1,alpha=alpha,significance.threshold=c(\"fdr\",\"bonferroni\"))\n  }\n\nexplain_phewas_bon <- function(res,verbose){\n  # Which parts of this table are we interested in explaining?\n  results_des<-addPhewasDescription(res)\n  signif_res <- results_des[results_des$bonferroni&!is.na(results_des$p),]\n  #print(dim(bonfer))\n  for (i in seq(1,dim(signif_res)[1])) {\n    print(paste(\"The SNP \",signif_res$snp[i],\" is significantly associated with \",\n                signif_res$phewas_description[i],\" (PheWAS code \",signif_res$phewas_code[i],\n                \") with a p-value of \",signif(signif_res$p[i], digits=3),\" after Bonferroni correction.\",\n                sep=''))\n      if (verbose) {\n        print((paste(\"PheWAS code \",signif_res$phewas_code[i],\" includes the following ICD-9 code(s): \",\n                     paste(phemap$icd9[phemap$phewas_code==signif_res$phewas_code[i]],collapse=', '),sep='')))\n    }\n  }\n\n  print(signif_res)\n}\n\nexplain_phewas_fdr <- function(res,verbose){\n  # Which parts of this table are we interested in explaining?\n  results_des<-addPhewasDescription(res)\n  signif_res <- results_des[results_des$fdr&!is.na(results_des$p),]\n  for (i in seq(1,dim(signif_res)[1])) {\n    print(paste(\"The SNP \",signif_res$snp[i],\" is significantly associated with \",\n                signif_res$phewas_description[i],\" (PheWAS code \",signif_res$phewas_code[i],\n                \") with a p-value of \",signif(signif_res$p[i], digits=3),\" after FDR correction.\",sep=''))\n      if (verbose) {\n        print((paste(\"PheWAS code \",signif_res$phewas_code[i],\" includes the following ICD-9 code(s): \",\n                     paste(phemap$icd9[phemap$phewas_code==signif_res$phewas_code[i]],collapse=', '),sep='')))\n      }\n    }\n  print(signif_res)\n}\n",
    "created" : 1455821538452.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3417446830",
    "id" : "4DC8243C",
    "lastKnownWriteTime" : 1456368174,
    "path" : "~/RadPheWAS/R/phewas.R",
    "project_path" : "R/phewas.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 6,
    "source_on_save" : true,
    "type" : "r_source"
}